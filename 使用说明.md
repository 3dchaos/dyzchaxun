# 游戏数据查询系统使用说明

## 系统概述

这是一个基于Web的游戏数据查询系统，可以查询游戏中的怪物、物品和地图信息，包括爆率、刷新位置等详细数据。

## 安装和启动

### 1. 环境要求
- Python 3.7 或更高版本
- Windows 操作系统（支持其他系统，但需要相应调整）

### 2. 安装步骤

1. **安装Python依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **准备数据文件**
   - 确保服务端目录结构正确：
     - `服务端根目录/Mir200/Envir/MonGen.txt`
     - `服务端根目录/Mir200/Envir/MonItems/`
     - `服务端根目录/Mir200/sqlite3.dll`

3. **启动程序**
   ```bash
   python main.py
   ```

4. **输入服务端根目录**
   按提示输入服务端根目录路径

5. **访问系统**
   在浏览器中打开：`http://localhost:8858`

## 数据文件格式

### MonGen.txt 文件格式
```
地图名 X坐标 Y坐标 怪物名 范围 数量 刷新时间(分钟) [国家] [颜色]
```

示例：
```
FOX02	277	205	红狐狸	400	300	15
WOLF01	150	100	灰狼	300	250	12
```

### 怪物爆出物品文件格式
文件名：`怪物名.txt`
内容格式：
```
概率 物品名
```

示例：
```
1/10 祈祷之刃
1/50 龙纹剑
1/100 屠龙刀
; 这是注释行
```

## 系统功能

### 1. 地图查询
- **功能**：查看所有地图及其怪物刷新信息
- **操作**：
  1. 点击"地图查询"标签
  2. 在搜索框中输入地图名进行筛选
  3. 点击地图名查看详细信息
  4. 在详情页面可以看到该地图的所有怪物刷新信息

### 2. 怪物查询
- **功能**：查看所有怪物及其爆出物品和出现地图
- **操作**：
  1. 点击"怪物查询"标签
  2. 在搜索框中输入怪物名进行筛选
  3. 点击怪物名查看详细信息
  4. 在详情页面可以看到：
     - 该怪物爆出的所有物品及概率
     - 该怪物出现的所有地图及刷新信息

### 3. 物品查询
- **功能**：查看所有物品及其爆出怪物
- **操作**：
  1. 点击"物品查询"标签
  2. 在搜索框中输入物品名进行筛选
  3. 点击物品名查看详细信息
  4. 在详情页面可以看到爆出该物品的所有怪物及概率

## 数据关系

### 地图 ↔ 怪物
- 一张地图可以有多个怪物刷新点
- 同一个怪物可以在多张地图刷新
- 每个刷新点包含坐标、范围、数量、刷新时间等信息

### 怪物 ↔ 物品
- 一个怪物可以爆出多种物品
- 每种物品都有对应的爆出概率
- 概率格式为"分子/分母"，如"1/10"表示10%概率

### 物品 ↔ 怪物
- 一种物品可以被多个怪物爆出
- 不同怪物爆出同一物品的概率可能不同

## 系统特性

### 1. 智能搜索
- 所有列表都支持实时搜索
- 搜索不区分大小写
- 支持部分匹配

### 2. 数据关联
- 点击任何项目都可以查看相关数据
- 支持跨标签页的数据关联查询
- 数据关系清晰，便于追踪

### 3. 响应式设计
- 界面美观，支持不同屏幕尺寸
- 操作流畅，用户体验良好
- 加载速度快，数据实时更新

### 4. 错误处理
- 自动检测端口占用
- 文件读取错误提示
- 数据格式验证

## 故障排除

### 1. 端口被占用
- 程序会自动检测端口8858是否被占用
- 如果被占用，会提示输入新端口号
- 输入新端口号后程序会继续运行

### 2. 文件读取错误
- 确保所有文本文件使用正确的编码（UTF-8或GBK）
- 检查文件路径是否正确
- 确保文件格式符合要求

### 3. 数据库错误
- 程序会自动创建数据库和表
- 如果数据库损坏，删除M2Data目录重新运行程序
- 确保有足够的磁盘空间

### 4. Web界面无法访问
- 检查防火墙设置
- 确认端口没有被其他程序占用
- 尝试使用不同的端口号

## 数据维护

### 1. 添加新怪物
1. 在 `Envir/MonItems/` 目录下创建新的怪物文件
2. 文件名格式：`怪物名.txt`
3. 在 `MonGen.txt` 中添加怪物的刷新配置
4. 重启程序，数据会自动更新

### 2. 修改爆率
1. 编辑对应的怪物文件
2. 修改概率值
3. 重启程序，数据会自动更新

### 3. 添加新地图
1. 在 `MonGen.txt` 中添加新地图的怪物刷新配置
2. 重启程序，数据会自动更新

## 性能优化

### 1. 大数据量处理
- 系统支持大量数据
- 数据库查询已优化
- 支持分页显示（可扩展）

### 2. 内存使用
- 数据按需加载
- 缓存机制减少重复查询
- 内存使用效率高

### 3. 响应速度
- 数据库索引优化
- 前端缓存机制
- 异步数据加载

## 扩展功能

系统设计具有良好的扩展性，可以轻松添加新功能：

1. **数据导出**：支持导出查询结果为Excel或CSV
2. **数据统计**：添加爆率统计、地图热度分析等
3. **用户权限**：添加用户登录和权限管理
4. **数据备份**：自动备份和恢复功能
5. **API接口**：提供RESTful API供其他系统调用

## 技术支持

如果遇到问题，请检查：

1. Python版本是否符合要求
2. 所有依赖是否正确安装
3. 数据文件格式是否正确
4. 端口是否被占用
5. 文件编码是否正确

系统日志会显示详细的错误信息，有助于问题诊断。 